# Configuration Files Analysis: Standardized vs Custom

## Summary

Most configuration files are **100% standardized** and should be created programmatically, not by the CLI agent. This saves ~2000 tokens per package and ensures consistency.

## Standardized Files (100% Identical)

These files are **exactly the same** for every package:

### 1. `tsconfig.json`
- **Status**: 100% standardized
- **Content**: Defined in `STANDARD_CONFIGS.tsconfig`
- **Fields**: 
  - `compilerOptions`: ES2020 target, strict mode, module resolution, etc.
  - `include`: `['src/**/*.ts']`
  - `exclude`: `['node_modules', 'dist']`
- **Should be created**: Programmatically via `scaffoldPackageConfig` activity

### 2. `jest.config.js`
- **Status**: 100% standardized
- **Content**: Defined in `STANDARD_CONFIGS.jest`
- **Fields**: TypeScript preset, coverage thresholds, test patterns
- **Should be created**: Programmatically via `scaffoldPackageConfig` activity

### 3. `.eslintrc.json`
- **Status**: 100% standardized
- **Content**: Defined in `STANDARD_CONFIGS.eslint`
- **Fields**: TypeScript parser, strict rules, BernierLLC standards
- **Should be created**: Programmatically via `scaffoldPackageConfig` activity

## Partially Standardized Files

### 4. `package.json`
- **Status**: Partially standardized (structure same, some fields vary)
- **Standardized parts** (same for all packages):
  - `scripts`: `build`, `test`, `lint`, `prepublishOnly` (identical)
  - `devDependencies`: TypeScript, Jest, ESLint versions (identical)
  - `type`: `'module'` (same)
  - `main`: `'dist/index.js'` (same)
  - `types`: `'dist/index.d.ts'` (same)
  - `author`: `'Bernier LLC'` (same)
  - `license`: `'UNLICENSED'` (same)
  - `publishConfig.access`: `'restricted'` (same)
  - `files`: `['dist', 'README.md']` (same)
- **Variable parts** (custom per package):
  - `name`: Package name (e.g., `@test/simple-package`)
  - `description`: Package description
  - `dependencies`: Package-specific dependencies
  - `keywords`: Package-specific keywords (plus `'bernier'` always included)
  - `version`: Usually `'0.1.0'` initially, but can vary
- **Should be created**: Programmatically via `scaffoldPackageConfig` activity (with variable fields filled in)

## Current Implementation

### Available Activity
There's a `scaffoldPackageConfig` activity in `gemini-agent.activities.ts` that:
- Creates standardized config files programmatically
- Saves ~2000 tokens per package (agent doesn't need to generate them)
- Ensures consistency across all packages
- Only creates files if they don't exist (skips if already present)

### Current Workflow Behavior
**`PackageBuildWorkflow`** (current):
- ❌ Does NOT use `scaffoldPackageConfig`
- ❌ Asks CLI agent to create config files via `scaffold-package` command
- ❌ Wastes ~2000 tokens per package
- ❌ Risk of inconsistent configs

**`GeminiTurnBasedAgentWorkflow`** (archived):
- ✅ Uses `scaffoldPackageConfig` activity
- ✅ Creates config files programmatically
- ✅ Saves tokens and ensures consistency

## Recommendation

**Use `scaffoldPackageConfig` activity in `PackageBuildWorkflow`** before asking the CLI agent to do any work. This will:

1. **Save ~2000 tokens** per package (agent doesn't need to generate configs)
2. **Ensure consistency** across all packages
3. **Eliminate config bugs** (like tsconfig excluding spec files)
4. **Speed up workflow** (programmatic creation is faster than CLI generation)

### Implementation

Add this to `PackageBuildWorkflow` in the scaffold phase, before the first `requestTaskBreakdown`:

```typescript
// Scaffold standard config files programmatically (saves ~2000 tokens)
const { scaffoldPackageConfig } = await import('../activities/gemini-agent.activities');
const scaffoldResult = await scaffoldPackageConfig({
  workspaceRoot: input.workspaceRoot,
  packagePath: input.packagePath,
  packageName: input.packageName,
  description: planContent.split('\n')[0] || `${input.packageName} - generated by Bernier LLC`,
  dependencies: input.dependencies || {},
  keywords: [] // Can extract from plan if needed
});

if (scaffoldResult.filesCreated.length > 0) {
  console.log(`[Scaffold] Created ${scaffoldResult.filesCreated.length} config files: ${scaffoldResult.filesCreated.join(', ')}`);
}
```

## Files That Are Always Custom

These files are **always custom** and should be created by the CLI agent:

- `src/**/*.ts` - Source code files (custom per package)
- `__tests__/**/*.test.ts` - Test files (custom per package)
- `README.md` - Documentation (custom per package, though structure can be templated)
- Any other implementation files

## Conclusion

**All configuration files (`tsconfig.json`, `jest.config.js`, `.eslintrc.json`, `package.json`) should be created programmatically** using the `scaffoldPackageConfig` activity, not by the CLI agent. This is a significant optimization opportunity that will reduce costs and improve consistency.

